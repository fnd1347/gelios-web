/*!
 * flip.js v1.4 | MIT License | (c) 2025 Maksim Postnikov
 * https://postnikovmd.com/mods/flip
 */

!function(e){let t=function(e,s){s=s||{},s={back:e+"-back",hover:!0,click:!1,single:!1,perspective:1500,transition:300,easing:"ease-in-out",...s},void 0===window.flip&&(window.flip={});let l=function(){let l=document.querySelectorAll(e);l.length?(l=t_filterElems(l),l.forEach((function(e){e.classList.add("flip-card","flip-front")}))):t_sendError("flip-no-fronts","Не найдены элементы ("+e+")");let r,c=document.querySelectorAll(s.back);if(c.length?(c=t_filterElems(c),c.forEach((function(e){e.classList.add("flip-card","flip-back")}))):t_sendError("flip-no-backs","Не найдены элементы ("+s.back+")"),l.length&&c.length){l.length!==c.length&&t_sendError("flip-diff-amount","Количество передних и задних сторон карточек не совпадает ("+e+" и "+s.back+")","warn");let d=l[0].closest(".t-rec");if(d){d.classList.add(e.substring(1)+"-block","tn-flip-block");let u=d.querySelector(".t396__artboard");if("window"===t396_ab__getFieldValue(u,"upscale")){function a(){d.setAttribute("data-zoom",""),window.tn_scale_factor&&void 0!==window.tn_scale_factor&&d.style.setProperty("--data-zoom",window.tn_scale_factor)}a(),window.addEventListener("resize",(function(){setTimeout((function(){a()}),1e3)}))}}if(s.cards=Math.ceil(l.length),(s.click||isMobile)&&(s.hover=!1,s.click=!0),s.click&&void 0!==s.link){let f=d.querySelectorAll('a[href="'+s.link+'"]');f.forEach((e=>e.closest(".tn-elem").classList.add("flip-link"))),f=d.querySelectorAll(".flip-link"),f.forEach((e=>e.querySelector("a").removeAttribute("href"))),s.links=Math.ceil(f.length/2)}for(let p=0;p<s.cards;p++){let m=l[p],v=c[p],w=document.createElement("div");w.className=e.substring(1)+"-container t-flip-container",m.parentNode.insertBefore(w,m),w.appendChild(v),w.appendChild(m)}document.querySelectorAll(e+"-container").forEach((t=>{if(s.hover&&(t.style.cursor="pointer",t.addEventListener("mouseenter",(()=>{t.classList.contains("active")||t.classList.add("active")})),t.addEventListener("mouseleave",(()=>{t.classList.contains("active")&&t.classList.remove("active")}))),s.click)if(void 0!==s.link&&s.links>0){let i=t.querySelector(".flip-front .flip-link"),o=t.querySelector(".flip-back .flip-link");i&&i.addEventListener("click",(function(){s.single&&n(e),t.classList.add("active")})),o&&o.addEventListener("click",(function(){t.classList.remove("active")}))}else t.style.cursor="pointer",t.addEventListener("click",(function(){t.classList.contains("active")?t.classList.remove("active"):(s.single&&n(e),t.classList.add("active"))}));window.rescale&&window.rescale.this&&!window.rescale.disabled&&t.setAttribute("data-rescale",""),/^((?!chrome|android).)*safari/i.test(navigator.userAgent)&&t.setAttribute("data-safari","")})),i(e,s),void 0===s.listeners&&(s.listeners={}),void 0===s.listeners.resize&&(window.addEventListener("resize",(function(){s.currentWidth!==window.innerWidth&&(clearTimeout(r),r=setTimeout((function(){o(e),setTimeout((function(){t(e,s)}),500),s.currentWidth=window.innerWidth}),100))})),s.listeners.resize=!0),s.id=e.substring(1).replace("uc-","").replace("rec",""),window.flip[s.id]=s,t_dispatchEvent("flip","init",s.id)}};void 0===s.event?t_onReady((function(){setTimeout((function(){l()}),300)})):void 0===s.timeout||isNaN(s.timeout)?t_catchEvent(s.event,(function(){l()})):t_catchEvent(s.event,(function(){setTimeout((function(){l()}),Math.max(s.timeout,0))}))},i=function(e,t){let i=document.querySelector(e+"-block"),n=e+"-block { --flip-transition: "+t.transition+"ms; --flip-easing: "+t.easing+"; --flip-perspective: "+t.perspective+"px }",o=document.createElement("style");if(o.classList.add("tn-flip-style"),o.textContent=n,i.appendChild(o),!window.flip.loaded){let e=document.createElement("link");e.rel="stylesheet",e.href="https://cdn.postnikovmd.com/tilda@"+window.flip.version+"/flip.min.css",document.head.appendChild(e),window.flip.loaded=!0}},n=function(e){document.querySelectorAll(e+"-container").forEach((function(e){e.classList.remove("active")}))},o=function(e){let t=e.substring(1).replace("uc-","").replace("rec","");if(window.flip&&window.flip[t]){document.querySelectorAll(e+"-container").forEach((e=>{let t=e.querySelector(".flip-front"),i=e.querySelector(".flip-back");e.replaceWith(...e.childNodes),t&&t.classList.remove("flip-card","flip-front"),i&&i.classList.remove("flip-card","flip-back"),e.style.cursor="",e.removeAttribute("data-rescale"),e.removeAttribute("data-safari")}));let t=document.querySelector(e+"-block");if(t){let i=t.querySelector(".tn-flip-style");i&&i.remove(),t.classList.remove(e.substring(1)+"-block","tn-flip-block"),t.removeAttribute("data-zoom"),t.style.removeProperty("--data-zoom"),window.removeEventListener("resize",(function(){setTimeout((function(){setScale()}),1e3)}))}}};window.t_filterElems=function(e,t){void 0===t&&(t={}),void 0===t.nesting&&(t.nesting=1),void 0===t.exclude&&(t.exclude=!1);let i=[];return e.length&&e.forEach((function(e){let n=e;if(n.classList.contains("tn-atom")&&(n=n.closest(".tn-elem")),t.exclude&&"none"===window.getComputedStyle(n).display)return;let o=n.closest(".tn-group");for(let e=1;e<t.nesting&&o;e++)o=o.parentElement?.closest(".tn-group");if(o&&null!==o)-1===i.indexOf(n.closest(".tn-group"))&&i.push(n.closest(".tn-group"));else{let o=e.closest(".tn-molecule");if(o){let e=o.closest(".tn-group");for(let i=1;i<t.nesting&&e;i++)e=e.parentElement?.closest(".tn-group");e&&null!==e?-1===i.indexOf(o.closest(".tn-group"))&&i.push(o.closest(".tn-group")):-1===i.indexOf(n)&&i.push(n)}else-1===i.indexOf(n)&&i.push(n)}})),i},window.t_catchEvent=function(e,t){let i=new Set,n=new Set;e.split(", ").map((function(e){return e.trim()})).forEach((function(e){n.add(e),window.addEventListener(e,(function(){i.add(e),i.size===n.size&&t()}))}))},window.t_dispatchEvent=function(e,t,i,n){void 0===n&&(n=10),void 0===t&&(t=""),i=void 0===i?"":"-"+i,setTimeout((function(){window.dispatchEvent(new Event(e+t+i))}),n)},window.t_sendError=function(e,t,i){window.mods||(window.mods={}),window.mods.errors||(window.mods.errors=[]),void 0===i&&(i="error");let n,o,s=e.indexOf("-");if(-1!==s?(n=e.substring(0,s),o=e.substring(s+1)):(n=e,o=void 0),!window.mods.errors.some((function(e){return e.message===t}))){let e={mod:n,type:i};void 0!==o&&(e.id=o),void 0!==t&&(e.message=t),window.mods.errors.push(e)}switch(i){case"error":i="Ошибка",console.error("["+n+".js] "+i+": "+t);break;case"warn":i="Предупреждение",console.warn("["+n+".js] "+i+": "+t)}},void 0===window.postnikovmd&&(window.postnikovmd="Maksim Postnikov, https://postnikovmd.com"),e.flip={init:t,destroy:o,version:"1.4",license:"MIT License: https://postnikovmd.com/mods/license",copyright:"© 2025 Maksim Postnikov"}}(window);